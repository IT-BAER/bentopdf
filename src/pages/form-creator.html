<!doctype html>
<html lang="de">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create PDF Form - PDF-Tools</title>
    <link rel="icon" type="image/png" href="../../images/favicon.svg" />
    <link href="../../src/css/styles.css" rel="stylesheet" />
</head>

<body class="antialiased">
    <nav class="navbar-glass sticky top-0 z-30">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 flex items-center cursor-pointer" id="home-logo">
                    <img src="../../public/images/favicon.svg" alt="PDF-Tools Logo" class="h-8 w-8" />
                    <span class="text-white font-bold text-xl ml-2">
                        <a href="/">PDF-Tools</a>
                    </span>
                </div>
                <div class="flex items-center gap-3">
                    <button id="theme-toggle-btn" 
                        class="w-8 h-8 rounded-lg border border-gray-600 bg-gray-700 hover:bg-gray-600 flex items-center justify-center text-gray-300 hover:text-white transition-colors"
                        title="Toggle Theme">
                        <i data-lucide="moon" class="w-4 h-4"></i>
                    </button>
                    <input type="color" id="accent-color-picker" 
                        class="w-8 h-8 rounded-lg border border-gray-600 cursor-pointer bg-transparent"
                        title="Accent Color" />
                    <select id="language-selector" 
                        class="bg-gray-700/50 text-white text-sm rounded-lg border border-gray-600 px-3 py-1.5 focus:ring-accent focus:border-accent cursor-pointer backdrop-blur-sm">
                        <option value="en">ðŸ‡¬ðŸ‡§ EN</option>
                        <option value="de">ðŸ‡©ðŸ‡ª DE</option>
                    </select>
                </div>
            </div>
        </div>
    </nav>

    <input type="file" id="pdfUploadInput" accept="application/pdf" class="hidden" />

    <!-- Upload Area (shown initially) -->
    <div id="upload-area" class="min-h-screen flex items-start justify-center p-4 pt-8">
        <div class="bg-gray-800/60 backdrop-blur-md rounded-xl shadow-xl p-6 max-w-5xl w-full text-gray-200 border border-gray-700/50">
            <button id="back-to-tools-upload"
                class="flex items-center gap-2 text-accent hover:opacity-80 mb-6 font-semibold transition-opacity">
                <i data-lucide="arrow-left" class="cursor-pointer"></i>
                <span class="cursor-pointer" data-i18n="backToTools">Back to Tools</span>
            </button>

            <h1 class="text-2xl font-bold text-white mb-2" data-i18n="formCreator.title">Create PDF Form</h1>
            <p class="text-gray-400 mb-6" data-i18n="formCreator.description">
                Upload an existing PDF or create a blank PDF to start adding form fields.
            </p>

            <!-- Recent Forms Section (hidden by default) -->
            <div id="recent-forms-container" class="mb-6 hidden">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-sm font-semibold text-gray-300 flex items-center gap-2">
                        <i data-lucide="clock" class="w-4 h-4"></i>
                        <span data-i18n="formCreator.recentForms">Recent Forms</span>
                    </h3>
                </div>
                <div id="recent-forms-list" class="space-y-2 max-h-64 overflow-y-auto">
                    <!-- Recent forms will be populated here -->
                </div>
            </div>

            <div class="relative flex flex-col items-center justify-center w-full h-44 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-700/50 hover:bg-gray-600/50 transition-colors duration-300"
                id="dropZone">
                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                    <i data-lucide="upload-cloud" class="w-10 h-10 mb-3 text-gray-400"></i>
                    <p class="mb-2 text-sm text-gray-300">
                        <span class="font-semibold" data-i18n="subpages.clickToSelect">Click to select a file</span> <span data-i18n="subpages.orDragDrop">or drag and drop</span>
                    </p>
                    <p class="text-xs text-gray-500" data-i18n="subpages.singlePdfFile">A single PDF file</p>
                    <p class="text-xs text-gray-500" data-i18n="subpages.filesNeverLeave">Your files never leave your device.</p>
                </div>
                <input type="file" id="pdfFileInput" accept="application/pdf"
                    class="absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer" />
            </div>

            <div id="fileList" class="mt-4 hidden text-sm text-gray-200"></div>

            <!-- OR Separator -->
            <div class="relative my-6">
                <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-600"></div>
                </div>
                <div class="relative flex justify-center text-sm">
                    <span class="px-4 bg-gray-800 text-gray-400 font-medium" data-i18n="formCreator.or">OR</span>
                </div>
            </div>

            <div class="flex justify-center">
                <button id="blankPdfBtn"
                    class="bg-gray-700/50 hover:bg-gray-600/50 text-white px-6 py-3 rounded-lg flex items-center justify-center gap-3 transition-colors border border-gray-600/50">
                    <i data-lucide="file-plus" class="w-5 h-5"></i>
                    <span class="font-semibold" data-i18n="formCreator.createBlankPdf">Create Blank PDF</span>
                </button>
            </div>

                <div id="pageSizeSelector" class="mt-4 hidden">
                    <label class="form-label" data-i18n="formCreator.pageSize">Page Size:</label>
                    <select id="pageSizeSelect" class="form-select">
                        <option value="letter" data-i18n="formCreator.pageSizeLetter">Letter (8.5" Ã— 11")</option>
                        <option value="a4" data-i18n="formCreator.pageSizeA4">A4 (210mm Ã— 297mm)</option>
                        <option value="a5" data-i18n="formCreator.pageSizeA5">A5 (148mm Ã— 210mm)</option>
                        <option value="legal" data-i18n="formCreator.pageSizeLegal">Legal (8.5" Ã— 14")</option>
                        <option value="tabloid" data-i18n="formCreator.pageSizeTabloid">Tabloid (11" Ã— 17")</option>
                        <option value="a3" data-i18n="formCreator.pageSizeA3">A3 (297mm Ã— 420mm)</option>
                        <option value="custom" data-i18n="formCreator.pageSizeCustom">Custom</option>
                    </select>

                    <div id="customDimensionsInput" class="mt-3 hidden space-y-2">
                        <div class="flex gap-2">
                            <div class="flex-1">
                                <label class="form-label" data-i18n="formCreator.width">Width (pts)</label>
                                <input type="number" id="customWidth" placeholder="612" min="72" max="14400" class="form-input">
                            </div>
                            <div class="flex-1">
                                <label class="form-label" data-i18n="formCreator.height">Height (pts)</label>
                                <input type="number" id="customHeight" placeholder="792" min="72" max="14400" class="form-input">
                            </div>
                        </div>
                        <p class="form-hint" data-i18n="formCreator.pointsHint">1 inch = 72 points</p>
                    </div>

                    <div class="flex justify-center mt-3">
                        <button id="confirmBlankBtn"
                            class="btn-gradient px-8 py-2 rounded-lg transition-colors">
                            <span data-i18n="formCreator.startCreating">Start Creating</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tool Container (hidden initially) -->
    <div id="tool-container" class="min-h-screen flex items-start justify-center p-4 pt-8 hidden">
        <div class="bg-gray-800/60 backdrop-blur-md rounded-xl shadow-xl p-6 w-full text-gray-200 border border-gray-700/50">
            <button id="back-to-tools-creator"
                class="flex items-center gap-2 text-accent hover:opacity-80 mb-6 font-semibold transition-opacity">
                <i data-lucide="arrow-left" class="cursor-pointer"></i>
                <span class="cursor-pointer" data-i18n="backToTools">Back to Tools</span>
            </button>

            <h1 class="text-2xl font-bold text-white mb-2" data-i18n="formCreator.title">Create PDF Form</h1>
            <p class="text-gray-400 mb-6" data-i18n="formCreator.toolDescription">
                Drag and drop fields onto the canvas to create a fillable PDF form. Customize field properties and
                download your form.
            </p>

            <!-- Main Form Creator Area -->
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- Sidebar with Properties -->
                <aside class="lg:w-64 flex-shrink-0 order-2 lg:order-1">
                    <!-- Properties Section -->
                    <div class="bg-gray-700/50 rounded-lg p-4 border border-gray-600/50">
                        <h2 class="font-semibold text-gray-200 mb-3 flex items-center gap-2">
                            <i data-lucide="settings" class="w-4 h-4"></i>
                            <span data-i18n="formCreator.properties">Properties</span>
                        </h2>
                        <div id="propertiesPanel" class="space-y-3">
                            <p class="text-gray-500 text-sm" data-i18n="formCreator.selectField">Select a field to edit properties</p>
                        </div>
                    </div>

                    <!-- Field Count -->
                    <div class="mt-4 bg-gray-700/50 rounded-lg p-3 text-center border border-gray-600/50">
                        <p class="text-sm text-gray-400">
                            <span id="fieldCount" class="text-accent font-bold text-lg">0</span> <span data-i18n="formCreator.fields">field(s)</span>
                        </p>
                        <p class="text-xs text-gray-500 mt-1" data-i18n="formCreator.deleteHint">Press Delete to remove selected field</p>
                    </div>
                </aside>

                <!-- Canvas Area -->
                <main class="flex-1 order-1 lg:order-2 min-w-0">
                    <!-- Page Management Toolbar -->
                    <div class="bg-gray-700/50 rounded-lg p-3 mb-4 flex flex-wrap gap-2 justify-between items-center border border-gray-600/50">
                        <div class="flex items-center gap-2">
                            <button id="prevPageBtn"
                                class="bg-gray-600/50 hover:bg-gray-500/50 text-white p-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                disabled>
                                <i data-lucide="chevron-left" class="w-4 h-4"></i>
                            </button>
                            <span id="pageIndicator" class="text-sm text-gray-300 px-2">Seite 1 von 1</span>
                            <button id="nextPageBtn"
                                class="bg-gray-600/50 hover:bg-gray-500/50 text-white p-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                disabled>
                                <i data-lucide="chevron-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="resetBtn"
                                class="bg-gray-600/50 hover:bg-gray-500/50 text-white p-2 px-3 rounded-lg flex items-center gap-2 transition-colors">
                                <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                                <span class="text-sm" data-i18n="formCreator.reset">Reset</span>
                            </button>
                            <button id="addPageBtn"
                                class="btn-gradient p-2 px-3 rounded-lg flex items-center gap-2 transition-colors">
                                <i data-lucide="file-plus" class="w-4 h-4"></i>
                                <span class="text-sm" data-i18n="formCreator.addPage">Add Page</span>
                            </button>
                        </div>
                    </div>

                    <!-- Top Toolbar -->
                    <div class="bg-gray-700/50 rounded-lg p-2 mb-4 border border-gray-600/50">
                        <div class="flex flex-wrap gap-2 justify-center items-center max-w-full overflow-hidden">
                            <div class="text-gray-400 text-sm font-semibold mr-2 flex items-center gap-1">
                                <i data-lucide="wrench" class="w-4 h-4"></i> <span data-i18n="formCreator.fieldsLabel">Fields:</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="text" title="Text Field">
                                <i data-lucide="type" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldText">Text</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="checkbox" title="Checkbox">
                                <i data-lucide="check-square" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldCheckbox">Checkbox</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="radio" title="Radio Button">
                                <i data-lucide="circle-dot" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldRadio">Radio</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="dropdown" title="Dropdown">
                                <i data-lucide="chevron-down-square" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldDropdown">Dropdown</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="optionlist" title="Option List">
                                <i data-lucide="list" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldList">List</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="button" title="Button">
                                <i data-lucide="square-mouse-pointer" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldButton">Button</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="signature" title="Signature">
                                <i data-lucide="pen-tool" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldSignature">Signature</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="date" title="Date Field">
                                <i data-lucide="calendar" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldDate">Date</span>
                            </div>

                            <div class="tool-item bg-gray-600/50 hover:bg-accent text-white p-2 rounded-lg cursor-move transition-colors flex items-center gap-2 border border-gray-500/50"
                                draggable="true" data-type="image" title="Image Field">
                                <i data-lucide="image" class="w-4 h-4"></i>
                                <span class="text-xs" data-i18n="formCreator.fieldImage">Image</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-700/50 rounded-lg p-4 mb-4 overflow-auto w-full border border-gray-600/50">
                        <div class="flex justify-center">
                            <div id="pdfCanvasWrapper" class="shadow-2xl relative" style="border: 1px solid rgba(55, 65, 81, 0.5);">
                                <div id="pdfCanvas" class="bg-white relative">
                                    <!-- Fields will be added here dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end gap-3">
                        <button id="saveBtn" class="btn-secondary flex items-center justify-center gap-2 py-3">
                            <i data-lucide="save" class="w-5 h-5"></i>
                            <span data-i18n="formCreator.saveForm">Save to Browser</span>
                        </button>
                        <button id="downloadBtn" class="btn-gradient flex items-center justify-center gap-2 py-3">
                            <i data-lucide="download" class="w-5 h-5"></i>
                            <span data-i18n="formCreator.downloadPdf">Download PDF Form</span>
                        </button>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <footer class="mt-16 border-t border-gray-700/50 py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="flex items-center">
                    <img src="../../public/images/favicon.svg" alt="PDF-Tools Logo" class="h-8 w-8 mr-2" />
                    <span class="text-lg font-bold text-white">PDF-Tools</span>
                </div>
                <p class="text-gray-400 text-sm">
                    &copy; 2025 PDF-Tools. <span data-i18n="allRightsReserved">All rights reserved.</span>
                </p>
                <p class="text-gray-500 text-xs">
                    <span data-i18n="version">Version</span> <span id="app-version"></span>
                </p>
            </div>
        </div>
    </footer>

    <!-- Custom Modal -->
    <div id="errorModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/75 backdrop-blur-sm">
        <div class="bg-gray-800/90 backdrop-blur-md rounded-xl shadow-2xl max-w-md w-full mx-4 border border-gray-700/50">
            <div class="p-6">
                <h3 id="errorModalTitle" class="text-xl font-bold text-white mb-3" data-i18n="formCreator.errorTitle">Error</h3>
                <p id="errorModalMessage" class="text-gray-300 mb-6" data-i18n="formCreator.errorDefault">An error occurred.</p>
                <button id="errorModalClose"
                    class="w-full btn-gradient font-semibold py-2 px-4 rounded-lg transition-colors" data-i18n="formCreator.close">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Load configuration file (can be customized for server deployments) -->
    <script src="/config.js"></script>
    <script type="module" src="../js/utils/lucide-init.ts"></script>
    <script type="module" src="../js/utils/full-width.ts"></script>
    <script type="module" src="../version.ts"></script>
    <script type="module" src="../js/logic/form-creator.ts"></script>
    <script type="module" src="../js/utils/page-init.ts"></script>
</body>

</html>
